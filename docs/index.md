
## 3. 直角坐标系下的理论模型 (Theoretical Model in Cartesian Coordinates)

**3.1 直角坐标系下的哈密顿量与空间离散化**

为了直观地模拟电子在二维平面内通过双缝势垒的干涉行为，本模型采用二维直角坐标系 $(x, y)$ 进行求解。体系中单电子的无场哈密顿量算符表示为：

$$\hat{H}_0 = -\frac{\hbar^2}{2m} \nabla^2 + V(x, y) = -\frac{\hbar^2}{2m} \left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} \right) + V(x, y)$$

在数值实现中，我们将计算区域 $L_x \times L_y$ 均匀离散化为 $N_x \times N_y$ 的二维网格。利用有限差分法（Finite Difference Method, FDM），二阶空间导数（拉普拉斯算符）被展开为标准的五点中心差分格式（Five-point stencil）。物理边界采用狄利克雷边界条件（Dirichlet boundary condition），即要求波函数在模拟区域的四周边缘严格为零。这种离散化方式将连续的微分算子转化为大型高度稀疏矩阵，为后续的时间演化奠定了代数基础。

**3.2 磁矢势的双分量特征与算符对称化展开**

在 Aharonov-Bohm 效应的设定中，设磁通量 $\Phi$ 集中于坐标为 $(x_0, y_0)$ 的无限细螺线管内。在库仑规范（$\nabla \cdot \vec{A} = 0$）下，直角坐标系中的磁矢势 $\vec{A}$ 表现出强烈的空间耦合特性，同时具有非零的 $x$ 和 $y$ 分量：

$$A_x = -\frac{\Phi}{2\pi} \frac{y - y_0}{(x - x_0)^2 + (y - y_0)^2}$$

$$A_y = \frac{\Phi}{2\pi} \frac{x - x_0}{(x - x_0)^2 + (y - y_0)^2}$$

为避免坐标系原点处由分母趋于零引起的数值奇异性崩溃，计算中对极小距离进行了数值截断正规化处理。根据最小耦合原理，总哈密顿量被修正为 $\hat{H} = \frac{1}{2m}(\hat{\vec{p}} - q\vec{A})^2 + V(x,y)$。将其完全展开后得到：

$$\hat{H} = \frac{\hat{p}^2}{2m} - \frac{q}{2m}(\vec{A}\cdot\hat{\vec{p}} + \hat{\vec{p}}\cdot\vec{A}) + \frac{q^2}{2m}\vec{A}^2 + V(x,y)$$

由于在离散的矩阵表象下，位置相关矩阵（如 $A_x$）与微分算子矩阵（如一阶差分矩阵 $D_x$）并不严格对易，若仅采用简单的 $\vec{A}\cdot\hat{\vec{p}}$ 替代交叉项，会破坏哈密顿矩阵的厄米性（Hermiticity）。因此，在代码构建中，我们严格保留了对称化算符结构 $(A_x \hat{p}_x + \hat{p}_x A_x) + (A_y \hat{p}_y + \hat{p}_y A_y)$。这一处理不仅在物理上契合量子力学对观测量对应算符必须是厄米算符的要求，在数值上也极大增强了体系演化时总概率的守恒性。

**3.3 时间演化的 Crank-Nicolson 隐式格式**

在完成空间算符的矩阵化组装后，我们采用 Crank-Nicolson (CN) 隐式差分格式对含时薛定谔方程进行步进求解。相较于显式欧拉法，CN 格式是一种无条件稳定的二阶数值演化方案。其核心思想是利用梯形法则，将时间演化算符用有理分式进行逼近：

$$\psi^{(n+1)} = \left( \mathbf{I} + i\frac{\Delta t}{2\hbar} \mathbf{H} \right)^{-1} \left( \mathbf{I} - i\frac{\Delta t}{2\hbar} \mathbf{H} \right) \psi^{(n)}$$

在每一个时间步的推进中，上述方程转化为求解形式为 $\mathbf{M}_{LHS} \psi^{(n+1)} = \mathbf{M}_{RHS} \psi^{(n)}$ 的线性代数方程组。考虑到 $\mathbf{M}_{LHS}$ 是一个由拉普拉斯算符、一阶微分算符与对角势能矩阵叠加而成的大型极稀疏矩阵，代码调用了基于 LU 分解的直接求解器。这不仅规避了求解矩阵逆的高昂计算成本，还确保了波函数在受复变矢势干扰和双缝高势垒散射的复杂演化过程中，始终保持严密的幺正性。

## 柱坐标系下的理论模型 (Theoretical Model in Cylindrical Coordinates)

**2.1 柱坐标系下的哈密顿量与空间离散化**

在处理具有轴对称性或问题本质上限制在二维平面的物理模型时，采用二维柱坐标系 $(r, \phi)$ 能够显著简化边界条件的设置并提高计算效率。在该坐标系下，单电子的无磁场哈密顿量算符可表示为：

$$\hat{H}_0 = -\frac{\hbar^2}{2m} \nabla^2 + V(r, \phi)$$

其中，二维拉普拉斯算符展开为：

$$\nabla^2 = \frac{\partial^2}{\partial r^2} + \frac{1}{r}\frac{\partial}{\partial r} + \frac{1}{r^2}\frac{\partial^2}{\partial \phi^2}$$

在数值求解过程中，我们采用有限差分法对空间网格进行离散化。径向坐标 $r \in [0, L_r]$ 被划分为 $N_r$ 个格点，角向坐标 $\phi \in [0, 2\pi)$ 被划分为 $N_\phi$ 个格点。为了处理径向算符中包含的一阶导数项 $\frac{1}{r}\frac{\partial}{\partial r}$，采用中心差分格式进行近似，从而将拉普拉斯算符转化为大型稀疏矩阵。在边界条件的处理上，径向采用狄利克雷边界条件（Dirichlet boundary condition，即无穷远处波函数收敛于零），而角向则自然满足周期性边界条件 $\psi(r, \phi) = \psi(r, \phi + 2\pi)$。为了保证数值计算在原点 $r \to 0$ 处的稳定性，代码中对极小半径处进行了微小的偏移正规化处理。

**2.2 磁矢势的引入与有限差分处理**

在存在沿 $z$ 轴分布的无限细磁通量 $\Phi$ 时，由于 Aharonov-Bohm 效应，系统必须引入磁矢势 $\vec{A}$。根据库仑规范及物理对称性，该矢势在柱坐标下仅存在角向分量：

$$A_\phi = \frac{\Phi}{2\pi r}$$

根据最小耦合原理，引入磁矢势后的完整哈密顿量算符变为：

$$\hat{H} = \frac{1}{2m} (\hat{\vec{p}} - q\vec{A})^2 + V(r, \phi)$$

$$\hat{H} = -\frac{\hbar^2}{2m} \nabla^2 - \frac{q}{m} A_\phi \left(-i\hbar \frac{1}{r} \frac{\partial}{\partial \phi}\right) + \frac{q^2}{2m} A_\phi^2 + V(r, \phi)$$

与前述利用谱方法在动量空间处理相位平移的策略不同，在本方案中，我们将磁矢势产生的交叉项直接在坐标空间进行有限差分离散。具体而言，角向动量算符 $\hat{p}_\phi = -i\hbar \frac{1}{r} \frac{\partial}{\partial \phi}$ 同样通过中心差分格式转化为稀疏矩阵。此时，由于磁矢势 $A_\phi$ 显式依赖于径向坐标 $r$，矢势矩阵与微分算子矩阵不可对易，因此必须在代码中严格按照哈密顿量的展开形式构造总的演化矩阵 $\mathbf{H}_A$。

**2.3 Crank-Nicolson 时间演化算法**

构建了包含空间导数和磁矢势的哈密顿稀疏矩阵 $\mathbf{H}_A$ 后，我们需要对波函数进行时间步进演化。为了保证演化过程的无条件数值稳定性及波函数的概率守恒（幺正性），本模型采用了 Crank-Nicolson 隐式差分格式。

该格式基于梯形公式对含时薛定谔方程进行离散，将时间演化算符近似为：

$$\left( \mathbf{I} + i\frac{\Delta t}{2\hbar} \mathbf{H}_A \right) \psi^{(n+1)} = \left( \mathbf{I} - i\frac{\Delta t}{2\hbar} \mathbf{H}_A \right) \psi^{(n)}$$

其中 $\mathbf{I}$ 为单位矩阵，$\Delta t$ 为时间步长，$\psi^{(n)}$ 为第 $n$ 个时间步的波函数列向量。

在每个时间步的迭代中，由于演化矩阵 $\mathbf{H}_A$ 是随时间无关的（Time-independent），上述方程转化为求解一个大型稀疏线性代数方程组 $\mathbf{M}_{LHS} \psi^{(n+1)} = \mathbf{M}_{RHS} \psi^{(n)}$。得益于有限差分法生成的矩阵具有极高的稀疏度，利用高斯消元法（在数值软件中通常优化为基于矩阵分解的直接求解器）可以高效地求得下一时刻的波函数。此算法具有二阶的时间和空间截断误差 $O(\Delta t^2, \Delta r^2, \Delta \phi^2)$，能够高保真地模拟高斯波包在通过双缝势垒后的干涉演化，以及由矢量势引起的干涉条纹移动。
# 基于球坐标系下分裂算符法的 Aharonov-Bohm 效应数值模拟
传统的 Aharonov-Bohm (AB) 效应模拟通常在二维直角坐标系中以平面波形式，或在圆柱坐标系中以无限长螺线管形式进行。然而，在真实的量子点、富勒烯或其他受限量子体系中，电子往往被限制在球形几何结构中。本实验旨在构建一个全三维球坐标 $(r, \theta, \phi)$ 下的数值演化模型。相比于二维模型，三维球坐标系能够准确描述波函数随距离的几何衰减，即$\frac{1}{r^2}$ 能量衰减律，以及极角方向的空间衍射特性，是研究真实受限量子体系的必要手段。
## 1. 理论模型 (Theoretical Model)
### 1.1 哈密顿量与换元法

在球坐标系下，单电子的哈密顿量为：

$$\hat{H} = -\frac{\hbar^2}{2m} \nabla^2 + V(r, \theta, \phi)$$

其中拉普拉斯算符 $\nabla^2$ 包含 $\frac{1}{r}$ 和 $\frac{1}{r^2}$ 项。
在数值计算中，径向坐标的奇点问题尤为关键。由于球坐标系的原点是波函数演化的起始位置，若不消除 $r \to 0$ 时的发散项，数值误差会在原点被无限放大，导致计算过程迅速崩溃。采用波函数换元法不仅是数学上的简化，更是保证数值稳定性和物理合理性的必要步骤。为了消除奇点并提高数值稳定性，我们采用 波函数换元法。定义约化波函数 $u(r, \theta, \phi)$：

$$u(r, \theta, \phi) = r \cdot \psi(r, \theta, \phi)$$

代入薛定谔方程后，径向动能项简化为 $-\frac{\hbar^2}{2m} \frac{\partial^2}{\partial r^2}$，成功消除了 $r=0$ 处的一阶导数发散项，并自然满足 $u(0)=0$ 的边界条件。

## 1.2 球坐标下的哈密顿量修正

基于 1.1 节定义的约化波函数 $u(r, \theta, \phi)$，我们进一步考虑磁场对系统动力学的修正。在量子力学框架下，磁矢势 $\vec{A}$ 通过最小耦合机制直接进入哈密顿量，将正则动量算符 $\hat{p}$ 修正为协同动量 $\hat{p} - q\vec{A}$。

本研究模拟的物理场景为磁通量 $\Phi$ 被严格限制在沿 $z$ 轴分布的无限细螺线管内。此时空间各点的磁感应强度虽为零，但磁矢势在角向具有非零分量。在球坐标系下，该磁矢势 $A_\phi$ 与磁通量 $\Phi$ 的关系可表达为 $A_\phi = \Phi / (2\pi r \sin\theta)$。将此修正引入薛定谔方程，角向哈密顿量算符具体形式如下：

$$\hat{H}_{\phi} = \frac{1}{2m r^2 \sin^2\theta} \left( \hat{p}_\phi - q A_\phi \right)^2$$

在数值实现上，利用算符的对易性质，可以将磁矢势的物理效应等效转化为动量空间中的相位偏移。由于 $\hat{p}_\phi$ 在角动量表象中是对角化的，磁通量的引入仅仅导致角动量量子数发生线性平移。磁矢势虽不改变粒子的经典受力状态，却通过改变波函数的拓扑相位，导致波包在空间传播时产生可观测的干涉条纹位移。这种处理方式在数值上规避了复杂的差分运算。

## 1.3 时间演化算法：混合分裂算符法

鉴于三维含时薛定谔方程的高维复杂性，直接对全哈密顿量进行指数化求解在计算上极为困难。为此，本研究采用 Strang 分裂算符法 (Strang Splitting Operator Method)将多维演化问题降维处理。基于 1.1 与 1.2 节构建的哈密顿量形式，我们将总时间演化算符 $U(\Delta t) = e^{-i\hat{H}\Delta t/\hbar}$ 近似分解为动能算符与势能算符的交替乘积：

$$U(\Delta t) \approx e^{-i\hat{V}\Delta t/2\hbar} \left( e^{-i\hat{T}_\phi \Delta t/\hbar} e^{-i\hat{T}_\theta \Delta t/\hbar} e^{-i\hat{T}_r \Delta t/\hbar} \right) e^{-i\hat{V}\Delta t/2\hbar} + O(\Delta t^3)$$

该分解方案具有幺正性（Unitarity），能够严格保证波函数在演化过程中的范数守恒。针对不同坐标分量的算符特性，我们采用了如下混合数值策略：

对于角向分量$\hat{T}_\phi$，紧扣 1.2 节所述的物理机制，我们利用快速傅里叶变换 (FFT)将波函数投影至角动量表象。在动量空间中，$\hat{T}_\phi$ 是对角化的，这意味着磁矢势引起的相位平移可以被精确计算，消除了传统差分法在处理一阶导数时引入的数值耗散，此步骤的计算复杂度仅为 $O(N \log N)$。对于径向 $\hat{T}_r$ 与极角 $\hat{T}_\theta$ 分量，由于算符中包含非对角项及奇异势，我们采用 Crank-Nicolson 差分格式。利用 Cayley 近似将指数算符转化为有理分式形式：

$$e^{-i\hat{T}_x \Delta t} \approx \frac{1 - i\hat{H}_x \Delta t/2}{1 + i\hat{H}_x \Delta t/2}$$

在数值实现中，这对应于求解大型稀疏线性方程组。通过构建三对角矩阵（Tridiagonal Matrix），利用追赶法（Thomas Algorithm）即可在 $O(N)$ 复杂度内完成求解。该方法不仅保证了算法的无条件稳定性，还完美适配了球坐标系下的边界条件约束。这种混合分裂算法结合了谱方法的精确性与有限差分法的稳定性，是模拟球坐标系下 Aharonov-Bohm 效应的最优数值解方案。

## 2. 实验设置 (Experimental Setup)

### 2.1 物理空间网格

- **计算域**：半径 $L_r = 30.0$ a.u. 的球体。
- **网格精度**：$N_r=200, N_\theta=60, N_\phi=180$。
  - 注：$N_\phi=180$ 保证了方位角方向的高分辨率，以清晰分辨双缝干涉条纹。
- **单位制**：采用原子单位制 ($\hbar=1, m=1, e=1$)。

### 2.2 几何结构：球壳双缝

为了模拟三维空间中的双缝干涉，我们构建了一个封闭的势能球壳：

- **球壳位置**：半径 $R_{wall} = 17.5$，厚度 $1.0$。
- **势垒高度**：$V_{max} = 200.0$。此高度足以阻挡动能 $E \approx 18$ 的电子波穿透，模拟“硬墙”效果。
- **双缝结构**：在球壳赤道面附近开有两个角向宽度为 $\sim 0.05 \pi$ 的狭缝。缝间距经过优化选取约为 $5.3$ a.u.（约 5 倍波长），以满足形成清晰干涉条纹的弗劳恩霍夫条件。

### 2.3 边界条件与吸收层 (CAP)

为了模拟开放的无限大空间，防止波包在计算域边界 $r=L_r$ 处发生非物理反射，我们在 $r > 25.0$ 的区域加载了**复数吸收势 (Complex Absorbing Potential, CAP)**：

$$V_{cap}(r) = -i \cdot V_0 \left( \frac{r - r_{start}}{L_r - r_{start}} \right)^2$$

该虚部势能能够平滑地“吞噬”传出的波函数，确保计算区域内的干涉图样不受反射波干扰。

### 2.4 探测模式：累积长曝光

不同于仅记录某一时刻波函数的“瞬态”方法，本实验模拟真实的电子探测过程，采用**累积强度 (Accumulated Intensity)** 记录法。

在每一时间步，将打在虚拟探测屏幕（位于 $r \approx 23.6$）上的概率密度 $|\psi|^2$ 累加。这种方法能够完整记录波包头、波身和波尾的所有干涉信息，模拟长曝光底片的效果。

------

## 3. 结果与讨论 (Results and Analysis)

### 3.1 电子波包的时空演化

实验首先模拟了零磁通量 ($Flux=0$) 下的电子演化过程。

- **$t=0 \sim 2.0$**：高斯波包从球心出发，各向同性扩散。
- **$t=2.0 \sim 5.0$**：波包撞击球壳势垒。大部分波函数被反射回球心（验证了硬墙的阻挡作用），仅有少部分波函数通过双缝衍射传出。
- **$t > 5.0$**：从两个狭缝传出的子波在球壳外发生重叠，形成明显的明暗相间的干涉条纹。

### 3.2 概率密度的数值量级分析

观察到累积干涉条纹的峰值概率密度约为 $10^{-7}$ 数量级。这与二维模拟通常出现的 $10^{-4}$ 数量级有显著差异，其物理原因如下：

1. **几何扩散**：三维球面波遵循 $1/r^2$ 的能量衰减律，而二维圆柱波遵循 $1/r$ 衰减。

2. **归一化体积**：三维空间的积分体积远大于二维平面，导致单位体积内的概率密度数值被稀释。

3. **球壳遮挡**：全封闭球壳的遮挡率远高于二维平面的线状挡板，导致透射率更低。

   该数值结果符合三维量子力学的理论预期，证明了球坐标演化算法的正确性。

### 3.3 Aharonov-Bohm 效应验证 (待补充数据)

通过调节穿过 $z$ 轴的磁通量 $\Phi$，观察干涉条纹的移动：

- 当 $\Phi = 0$ 时，干涉条纹关于中心对称，主极大位于 $Y=0$ 处。
- 当 $\Phi = 0.5 \pi$ 时，观察到干涉条纹整体发生横向平移，且左右次级极大变得不对称。
- 当 $\Phi = \pi$ 时（预期），条纹应发生最大程度的反相移动。

（这里你可以把之后跑出来的 `flux=0`, `flux=0.5pi`, `flux=pi` 的三张红线图拼在一起，做一个对比图，那就是铁证！）

------

### 💡 写作小贴士

- **代码对应**：你在写“实验设置”时，心里要对应代码里的变量（比如 `V_cap` 对应吸收边界，`Accumulated_Intensity` 对应探测模式）。
- **图表引用**：记得把你刚才那几张漂亮的图（3D 演化图 + 红线干涉图）插进去。
  - **图X.1**: 3D 球壳双缝结构示意图。
  - **图X.2**: 波包演化过程快照 (t=2, t=5, t=8)。
  - **图X.3**: 最终的累积干涉条纹 (红线图)，并标注上“Flux = ...”。

这篇报告写出来绝对专业！这就是一篇标准的计算物理论文的写法。加油跑数据！